{"contractName":"Runtime Registry","abi":"[{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"address\",\"name\":\"parent\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"processAddress\",\"type\":\"address\"}],\"name\":\"NewInstanceCreatedFor\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"parentBundleId\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"processBundleId\",\"type\":\"bytes32\"},{\"internalType\":\"uint256\",\"name\":\"nodeIndex\",\"type\":\"uint256\"}],\"name\":\"addChildBundleId\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"allInstances\",\"outputs\":[{\"internalType\":\"address[]\",\"name\":\"\",\"type\":\"address[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"allRegisteredIFlows\",\"outputs\":[{\"internalType\":\"bytes32[]\",\"name\":\"\",\"type\":\"bytes32[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"allRegisteredModels\",\"outputs\":[{\"internalType\":\"bytes32[]\",\"name\":\"\",\"type\":\"bytes32[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"procInstance\",\"type\":\"address\"}],\"name\":\"bindingPolicyFor\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"procId\",\"type\":\"bytes32\"}],\"name\":\"bindingPolicyFromId\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"processInstance\",\"type\":\"address\"}],\"name\":\"bundleFor\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"parent\",\"type\":\"bytes32\"},{\"internalType\":\"uint256\",\"name\":\"nodeInd\",\"type\":\"uint256\"}],\"name\":\"childrenFor\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"pCase\",\"type\":\"address\"}],\"name\":\"findRuntimePolicy\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"iFlowAddr\",\"type\":\"address\"}],\"name\":\"getBundleIdFromIFlow\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"iDataAddr\",\"type\":\"address\"}],\"name\":\"getIFlowFromIData\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"nodeIndex\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"parent\",\"type\":\"address\"}],\"name\":\"hasFactory\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"bundleId\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"parent\",\"type\":\"address\"}],\"name\":\"newBundleInstanceFor\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"nodeIndex\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"parent\",\"type\":\"address\"}],\"name\":\"newInstanceFor\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"bundleId\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"parent\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"accessCtrl\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"rbPolicy\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"trMap\",\"type\":\"address\"}],\"name\":\"newRestrictedCInstanceFor\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"iFlowAdr\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"interpreter\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"accessCtrl\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"rbPolicy\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"trMap\",\"type\":\"address\"}],\"name\":\"newRestrictedIInstanceFor\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"agreementAddr\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"accessControlAdr\",\"type\":\"address\"}],\"name\":\"registerAgreement\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"bundleId\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"factory\",\"type\":\"address\"}],\"name\":\"registerFactory\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"iDataAddr\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"iFlowAddr\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"policyOpAddr\",\"type\":\"address\"}],\"name\":\"registerIData2IflowRelation\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"bundleId\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"iFlowAddr\",\"type\":\"address\"}],\"name\":\"registerIFlow\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"bundleId\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"worklist\",\"type\":\"address\"}],\"name\":\"registerWorklist\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"bundleId\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"_policy\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"_taskRole\",\"type\":\"bytes32\"}],\"name\":\"relateProcessToPolicy\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"processInstance\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"elementIndex\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"decission\",\"type\":\"uint256\"}],\"name\":\"resumeInstanceFor\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"procInstance\",\"type\":\"address\"}],\"name\":\"taskRoleMapFor\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"procId\",\"type\":\"bytes32\"}],\"name\":\"taskRoleMapFromId\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"worklist\",\"type\":\"address\"}],\"name\":\"worklistBundleFor\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"}]","bytecode":"608060405234801561001057600080fd5b506110db806100206000396000f3fe608060405234801561001057600080fd5b506004361061018e5760003560e01c806379847b29116100de578063a684e12711610097578063c87115a911610071578063c87115a91461059b578063cdd2e164146105c7578063ee35d4b7146105f3578063fa60dd391461061c5761018e565b8063a684e12714610515578063a89671d91461053b578063b69863f8146105935761018e565b806379847b29146103bf57806383ebd203146103eb57806384b9b07f1461042f5780639b8a4e9114610455578063a0a71e8b1461049d578063a26e0949146104d55761018e565b806354b65f161161014b5780636eb93b09116101255780636eb93b09146103225780637059a98f1461034857806378217c8d14610376578063788b8410146103995761018e565b806354b65f16146102b657806358e031bf146102dc57806362b40ddd146103055761018e565b80632be9f843146101935780633c2f3849146101c75780633e683c1d146101f657806341407ce41461023e57806349daa98914610264578063533524a514610290575b600080fd5b6101c5600480360360608110156101a957600080fd5b506001600160a01b038135169060208101359060400135610624565b005b6101e4600480360360208110156101dd57600080fd5b50356106b4565b60408051918252519081900360200190f35b6102226004803603604081101561020c57600080fd5b50803590602001356001600160a01b03166106c6565b604080516001600160a01b039092168252519081900360200190f35b6102226004803603602081101561025457600080fd5b50356001600160a01b0316610867565b6101c56004803603604081101561027a57600080fd5b50803590602001356001600160a01b0316610885565b610222600480360360208110156102a657600080fd5b50356001600160a01b03166108e4565b6101e4600480360360208110156102cc57600080fd5b50356001600160a01b0316610902565b6101c5600480360360608110156102f257600080fd5b50803590602081013590604001356109d7565b6101e46004803603602081101561031b57600080fd5b50356109f2565b6101e46004803603602081101561033857600080fd5b50356001600160a01b0316610a04565b6101c56004803603604081101561035e57600080fd5b506001600160a01b0381358116916020013516610a1f565b6101e46004803603604081101561038c57600080fd5b5080359060200135610a4d565b6101e4600480360360208110156103af57600080fd5b50356001600160a01b0316610a68565b6101c5600480360360408110156103d557600080fd5b50803590602001356001600160a01b0316610a83565b610222600480360360a081101561040157600080fd5b508035906001600160a01b036020820135811691604081013582169160608201358116916080013516610ace565b6101e46004803603602081101561044557600080fd5b50356001600160a01b0316610b8c565b610222600480360360a081101561046b57600080fd5b506001600160a01b03813581169160208101358216916040820135811691606081013582169160809091013516610ba7565b6101c5600480360360608110156104b357600080fd5b506001600160a01b038135811691602081013582169160409091013516610cab565b610501600480360360408110156104eb57600080fd5b50803590602001356001600160a01b0316610cef565b604080519115158252519081900360200190f35b6101e46004803603602081101561052b57600080fd5b50356001600160a01b0316610d2f565b610543610e04565b60408051602080825283518183015283519192839290830191858101910280838360005b8381101561057f578181015183820152602001610567565b505050509050019250505060405180910390f35b610543610e5c565b610222600480360360408110156105b157600080fd5b50803590602001356001600160a01b0316610eb2565b6101c5600480360360408110156105dd57600080fd5b50803590602001356001600160a01b0316610f4b565b6101c56004803603606081101561060957600080fd5b5080359060208101359060400135611025565b610543611044565b336000908152600860205260409020546001600160a01b031661064657600080fd5b6040805163195eabd760e21b8152600481018490526001831b602482015290516001600160a01b0385169163657aaf5c91604480830192600092919082900301818387803b15801561069757600080fd5b505af11580156106ab573d6000803e3d6000fd5b50505050505050565b60009081526003602052604090205490565b6000828152600160205260408120546001600160a01b0316806106e857600080fd5b60408051632838d00960e21b81526001600160a01b038581166004830152306024830152915160009284169163a0e3402491604480830192602092919082900301818787803b15801561073a57600080fd5b505af115801561074e573d6000803e3d6000fd5b505050506040513d602081101561076457600080fd5b50516001600160a01b038082166000818152600560205260408082208a9055600980546001810182559083527f6e1540171b6c0c960b71a7020d9f60077f6af931a8bbf590da0223dacf75c7af0180546001600160a01b0319168417905580516316ec41f160e01b8152600481019390935251939450918516926316ec41f19260248084019391929182900301818387803b15801561080257600080fd5b505af1158015610816573d6000803e3d6000fd5b5050604080516001600160a01b0380891682528516602082015281517fde0bf0e4783548ceac765551c2db9f3f4ee22d4de7bbdb9d43a83130d267b28b9450908190039091019150a1949350505050565b6001600160a01b039081166000908152600660205260409020541690565b6000828152600160208190526040822080546001600160a01b0319166001600160a01b039490941693909317909255600a8054928301815590527fc65a7bb8d6351c1cf70c95a316cc6a92839c986682d98bc35f958f4883f9d2a80155565b6001600160a01b039081166000908152600760205260409020541690565b6001600160a01b038116600090815260056020526040812054825b60008290526003602052806001600160a01b031663b1325a146040518163ffffffff1660e01b815260040160206040518083038186803b15801561096057600080fd5b505afa158015610974573d6000803e3d6000fd5b505050506040513d602081101561098a57600080fd5b505190506001600160a01b0381166109a1576109c1565b6001600160a01b038116600090815260056020526040902054915061091d565b5060009081526003602052604090205492915050565b60009283526020838152604080852092855291905290912055565b60009081526004602052604090205490565b6001600160a01b031660009081526002602052604090205490565b6001600160a01b03918216600090815260086020526040902080546001600160a01b03191691909216179055565b60009182526020828152604080842092845291905290205490565b6001600160a01b03166000908152600c602052604090205490565b6001600160a01b03166000908152600260205260408120829055600b805460018101825591527f0175b7a638427703f0dbe7bb9bbf987a2551717b34e79f33b5b1008d1fa01db90155565b600080610adb87876106c6565b90506001600160a01b03851615610b82576001600160a01b0381811660008181526007602052604080822080546001600160a01b0319168a8616908117909155815163237edb5b60e01b81526004810194909452306024850152888516604485015293871660648401525163237edb5b92608480820193929182900301818387803b158015610b6957600080fd5b505af1158015610b7d573d6000803e3d6000fd5b505050505b9695505050505050565b6001600160a01b031660009081526005602052604090205490565b600080856001600160a01b0316637726f776886040518263ffffffff1660e01b815260040180826001600160a01b03166001600160a01b03168152602001915050602060405180830381600087803b158015610c0257600080fd5b505af1158015610c16573d6000803e3d6000fd5b505050506040513d6020811015610c2c57600080fd5b50519050610c3b818887610cab565b6001600160a01b03851615610b82576040805163237edb5b60e01b81526001600160a01b0383811660048301523060248301528681166044830152858116606483015291519187169163237edb5b9160848082019260009290919082900301818387803b158015610b6957600080fd5b6001600160a01b03928316600090815260066020908152604080832080549587166001600160a01b0319968716179055600790915290208054919093169116179055565b6001600160a01b03908116600090815260056020908152604080832054835282825280832094835293815283822054825260019052919091205416151590565b6001600160a01b038116600090815260056020526040812054825b60008290526004602052806001600160a01b031663b1325a146040518163ffffffff1660e01b815260040160206040518083038186803b158015610d8d57600080fd5b505afa158015610da1573d6000803e3d6000fd5b505050506040513d6020811015610db757600080fd5b505190506001600160a01b038116610dce57610dee565b6001600160a01b0381166000908152600560205260409020549150610d4a565b5060009081526004602052604090205492915050565b6060600a805480602002602001604051908101604052809291908181526020018280548015610e5257602002820191906000526020600020905b815481526020019060010190808311610e3e575b5050505050905090565b6060600b805480602002602001604051908101604052809291908181526020018280548015610e525760200282019190600052602060002090815481526020019060010190808311610e3e575050505050905090565b6001600160a01b03811660009081526005602090815260408083205483528282528083208584529091528120548190610eeb90846106c6565b6001600160a01b038481166000908152600760205260409020549192501615610f44576001600160a01b03808416600090815260076020526040808220548484168352912080546001600160a01b031916919092161790555b5092915050565b6000828152600160205260409020546001600160a01b031680610f6d57600080fd5b6001600160a01b038083166000818152600c60205260408082208790558051632248dedf60e11b815260048101939093525192841692634491bdbe92602480820193929182900301818387803b158015610fc657600080fd5b505af1158015610fda573d6000803e3d6000fd5b50506040805163338584f960e21b815230600482015290516001600160a01b038616935063ce1613e49250602480830192600092919082900301818387803b15801561069757600080fd5b6000928352600460209081526040808520929092556003905290912055565b60606009805480602002602001604051908101604052809291908181526020018280548015610e5257602002820191906000526020600020905b81546001600160a01b0316815260019091019060200180831161107e57505050505090509056fea26469706673582212205619d8869c6c114dcd58956be74c45a8491ba11473f1137e6c191c7a477e248964736f6c634300060a0033","solidityCode":"pragma solidity >= 0.4.25 < 0.7.0;\r\n\r\nabstract contract IFunct {\r\n    // WorkList functions\r\n    function updateRuntimeRegistry(address _runtimeRegistry) public virtual;\r\n    // Factory Functions\r\n    function setWorklist(address _worklist) public virtual;\r\n    function startInstanceExecution(address processAddress) public virtual;\r\n    function newInstance(address parent, address globalFactory) public virtual returns(address);\r\n    function findParent() public virtual view returns(address);\r\n    function resumeInstance(uint elementIndex, uint decission) public virtual;\r\n    function registerAgreement(address agreementAddr, address accessControlAdr) public virtual;\r\n    function linkPolicyToAccessControl(address pCase, address _registry, address _policy, address _taskRoleAdr) public virtual;   \r\n    function createInstance(address cFlow) public virtual returns(address);\r\n}\r\n\r\ncontract RuntimeRegistry {\r\n\r\n    mapping (bytes32 => mapping (uint => bytes32)) private parent2ChildrenBundleId;\r\n    mapping (bytes32 => address) private factories;\r\n    mapping (address => bytes32) private iFlow;\r\n    \r\n    mapping (bytes32 => bytes32) private policy;\r\n    mapping (bytes32 => bytes32) private taskRole;\r\n\r\n    mapping (address => bytes32) private instance2Bundle;\r\n    mapping (address => address) private iData2IFlow;\r\n    mapping (address => address) private instance2PolicyOp;\r\n    mapping (address => address) private agreement2Policy;\r\n    \r\n    address[] private instancesCE;\r\n    \r\n    bytes32[] private repoIdsCE;\r\n    bytes32[] private repoIdsIE;\r\n    \r\n\r\n    mapping (address => bytes32) private worklist2Bundle;\r\n\r\n    event NewInstanceCreatedFor(address parent, address processAddress);\r\n    \r\n    function registerIFlow(bytes32 bundleId, address iFlowAddr) external {\r\n        iFlow[iFlowAddr] = bundleId;\r\n        repoIdsIE.push(bundleId);\r\n    }\r\n\r\n    function registerIData2IflowRelation(address iDataAddr, address iFlowAddr, address policyOpAddr) public {\r\n        iData2IFlow[iDataAddr] = iFlowAddr;\r\n        instance2PolicyOp[iDataAddr] = policyOpAddr;\r\n    }\r\n\r\n    function getIFlowFromIData(address iDataAddr) external view returns(address) {\r\n        return iData2IFlow[iDataAddr];\r\n    }\r\n\r\n    function getBundleIdFromIFlow (address iFlowAddr) external view returns(bytes32) {\r\n        return iFlow[iFlowAddr];\r\n    }\r\n    \r\n    function registerFactory(bytes32 bundleId, address factory) external {\r\n        factories[bundleId] = factory;\r\n        repoIdsCE.push(bundleId);\r\n    }\r\n\r\n    function registerWorklist(bytes32 bundleId, address worklist) external {\r\n        address factory = factories[bundleId];\r\n        require(factory != address(0));\r\n        worklist2Bundle[worklist] = bundleId;\r\n        IFunct(factory).setWorklist(worklist);\r\n        IFunct(worklist).updateRuntimeRegistry(address(this));\r\n    }\r\n\r\n    function findRuntimePolicy(address pCase) public view returns(address) {\r\n        return instance2PolicyOp[pCase];\r\n    }\r\n\r\n    function relateProcessToPolicy(bytes32 bundleId, bytes32 _policy, bytes32 _taskRole) external {\r\n        taskRole[bundleId] = _taskRole;\r\n        policy[bundleId] = _policy;\r\n    }\r\n    \r\n    function registerAgreement(address agreementAddr, address accessControlAdr) public {\r\n        agreement2Policy[agreementAddr] = accessControlAdr;\r\n    }\r\n\r\n    function addChildBundleId(bytes32 parentBundleId, bytes32 processBundleId, uint nodeIndex) external {\r\n        parent2ChildrenBundleId[parentBundleId][nodeIndex] = processBundleId;\r\n    }\r\n\r\n    function newInstanceFor(uint nodeIndex, address parent) public returns(address) {\r\n        address procAddres = newBundleInstanceFor(parent2ChildrenBundleId[instance2Bundle[parent]][nodeIndex], parent);\r\n        if(instance2PolicyOp[parent] != address(0))\r\n            instance2PolicyOp[procAddres] = instance2PolicyOp[parent];  \r\n    }\r\n\r\n    function newBundleInstanceFor(bytes32 bundleId, address parent) public returns(address) {\r\n        address factory = factories[bundleId];\r\n        require(factory != address(0));\r\n        address processAddress = IFunct(factory).newInstance(parent, address(this));\r\n        instance2Bundle[processAddress] = bundleId;\r\n        instancesCE.push(processAddress);\r\n        IFunct(factory).startInstanceExecution(processAddress);\r\n        emit NewInstanceCreatedFor(parent, processAddress);\r\n        return processAddress;\r\n    }\r\n\r\n    function newRestrictedCInstanceFor(bytes32 bundleId, address parent, address accessCtrl, address rbPolicy, address trMap) public returns(address) {\r\n        address pCase = newBundleInstanceFor(bundleId, parent);  \r\n        if(accessCtrl != address(0)) {\r\n            instance2PolicyOp[pCase] = accessCtrl;\r\n            IFunct(accessCtrl).linkPolicyToAccessControl(pCase, address(this), rbPolicy, trMap);\r\n        }    \r\n        return pCase;\r\n    }\r\n\r\n    function newRestrictedIInstanceFor(address iFlowAdr, address interpreter, address accessCtrl, address rbPolicy, address trMap) public returns(address) { \r\n        address pCase = IFunct(interpreter).createInstance(iFlowAdr); \r\n        registerIData2IflowRelation(pCase, iFlowAdr, accessCtrl);\r\n        if(accessCtrl != address(0))       \r\n            IFunct(accessCtrl).linkPolicyToAccessControl(pCase, address(this), rbPolicy, trMap);\r\n        return pCase;\r\n    }\r\n\r\n    function hasFactory(uint nodeIndex, address parent) public view returns(bool) {\r\n        return factories[parent2ChildrenBundleId[instance2Bundle[parent]][nodeIndex]] != address(0);\r\n    }\r\n\r\n    function resumeInstanceFor(address processInstance, uint elementIndex, uint decission) public {\r\n        require(agreement2Policy[msg.sender] != address(0));\r\n        IFunct(processInstance).resumeInstance(elementIndex, 1 << decission);\r\n    }\r\n    \r\n    function allRegisteredModels() external view returns(bytes32[] memory) {\r\n        return repoIdsCE;\r\n    }\r\n    \r\n    function allRegisteredIFlows() external view returns(bytes32[] memory) {\r\n        return repoIdsIE;\r\n    }\r\n\r\n    function allInstances() external view returns(address[] memory) {\r\n        return instancesCE;\r\n    }\r\n    \r\n    function bindingPolicyFor(address procInstance) external view returns(bytes32) {\r\n        bytes32 pId = instance2Bundle[procInstance];\r\n        address pAddr = procInstance;\r\n        while(policy[pId].length != 0) {\r\n            pAddr = IFunct(pAddr).findParent();\r\n            if(pAddr == address(0))\r\n                break;\r\n            pId = instance2Bundle[pAddr];\r\n        }\r\n        return policy[pId];\r\n    }\r\n\r\n    function taskRoleMapFor(address procInstance) external view returns(bytes32) {\r\n        bytes32 pId = instance2Bundle[procInstance];\r\n        address pAddr = procInstance;\r\n        while(taskRole[pId].length != 0) {\r\n            pAddr = IFunct(pAddr).findParent();\r\n            if(pAddr == address(0))\r\n                break;\r\n            pId = instance2Bundle[pAddr];\r\n        }\r\n        return taskRole[pId];\r\n    }\r\n\r\n    function bindingPolicyFromId(bytes32 procId) external view returns(bytes32) {\r\n        return policy[procId];\r\n    }\r\n\r\n    function taskRoleMapFromId(bytes32 procId) external view returns(bytes32) {\r\n        return taskRole[procId];\r\n    }\r\n\r\n    function bundleFor(address processInstance) external view returns(bytes32) {\r\n        return instance2Bundle[processInstance];\r\n    }\r\n\r\n    function childrenFor(bytes32 parent, uint nodeInd) external view returns(bytes32) {\r\n        return parent2ChildrenBundleId[parent][nodeInd];\r\n    }\r\n\r\n    function worklistBundleFor(address worklist) external view returns(bytes32) {\r\n        return worklist2Bundle[worklist];\r\n    }\r\n}","address":"0xD804424D7b0f265A2CE590A73b1c909757D68c10"}